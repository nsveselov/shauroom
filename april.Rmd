
```{r загрузка данных и их фильтрация}
base<-read.csv("~/sss/shauroom/ex.csv") #Никите
unique(base$answer_text)
base$answer_text<- casefold(base$answer_text, upper=FALSE)
base$answer_text<-gsub(" ", "", base$answer_text, fixed = T) #чтобы не морочиться с пробелами
unique(base$answer_text)
#в общем файле может быть еще какая чушь
#наверняка можно проще, но всего один раз надо все это сделать и сохранить
#или вообще оставить лучше/хуже/согласен(сна), называть как угодно, с пробелами и большими буквами
for (i in 1:nrow(base)){
  if(base[i,8]=="шварматамлучше"){base[i,8]<-"шаверматамлучше"}
  if(base[i,8]=="шварматамхуже"){base[i,8]<-"шаверматамхуже"}
  if(base[i,8]=="согласен(сна)савтором"){base[i,8]<-"согласен"}
  if(base[i,8]=="согласен(на)савтором"){base[i,8]<-"согласен"}
  if(base[i,8]=="согласен(сна)савторос"){base[i,8]<-"согласен"}
  if(base[i,8]=="согалсен(сна)савтором"){base[i,8]<-"согласен"}
}
unique(base$answer_text)

```

```{r}
library(lattice)
b<-histogram(base$Оценка)
print(a)
paste(a)
base1<-base
base<-base1
base$id_post<-as.numeric(base$id_post)
base$Оценка<-gsub(",", ".", base$Оценка, fixed = T)
base$Оценка<-as.numeric(base$Оценка)
model <- lm(Оценка ~ id_post, data=base)
dnorm(base[2,4])
base$note<-predict(model, base$id_post)
b<-qqmath(~base$Оценка)

##
tt <- base %>%
  group_by(Оценка, id_post) %>%
  dplyr::summarise(count=n())
tt$Оценка<-as.numeric(tt$Оценка)
a<-histogram(tt$Оценка)
print(a)

```

